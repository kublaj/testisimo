var t,e;!function(){function t(t){t.onerror=function(t,e,n,o,s){testisimo?testisimo.error(s||t,e,n,o):r.push({error:s||t,file:e,line:n,column:o})}}function e(){0===o&&setTimeout(function(){for(;s.length;)s[0](),s.shift()},100)}function n(){}var o,s,i,r=[];t(window),o=0,s=[],function(t){XMLHttpRequest.prototype.open=function(){o++,this.addEventListener("readystatechange",function(){4===this.readyState&&o--,0>o&&(o=0),e()},!1),t.apply(this,arguments)}}(XMLHttpRequest.prototype.open),n.prototype.selectedClass="testisimo-selected",n.prototype.minStepWait=100,n.prototype.minActionWait=100,n.prototype.waitForElementInterval=250,n.prototype.maxWaitForElementAttempts=12,n.prototype.speed=1,n.prototype.resources={useCDN:!0,fontAwesome:"/3rd-party/font-awesome/css/font-awesome.css",fontAwesomeCDN:"//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",bootstrap:"/3rd-party/bootstrap/css/bootstrap.min.css",bootstrapCDN:"//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css",angular:"/3rd-party/angular/angular.min.js",angularCDN:"//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"},n.prototype.iframeId="testisimo-iframe",n.prototype.waitForAjaxDone=function(t){s.push(t),e()},n.prototype.listeners={_all:[]},n.prototype.addEventListener=function(t,e){1===arguments.length&&(e=arguments[0],t="_all"),this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e)},n.prototype.removeEventListener=function(t,e){1===arguments.length&&(e=arguments[0],t="_all"),this.listeners[t]=this.listeners[t]||[];var n=this.listeners[t].indexOf(e);n>-1&&this.listeners[t].splice(n,1)},n.prototype.eventsInterceptor=null,n.prototype.emit=function(t,e){var n,o,s;if(!this.silentMode){for(n=this.listeners[t]||[],o=0;o<n.length;o++)this.eventsInterceptor?this.eventsInterceptor(t,e,function(t,e){n[o](e)}):n[o](e);for(s=this.listeners._all,o=0;o<s.length;o++)this.eventsInterceptor?this.eventsInterceptor(t,e,function(t,e){s[o](t,e)}):s[o](t,e)}},n.prototype.addStyles=function(){var t=document.createElement("STYLE");t.id="testisimo-style",t.innerHTML="."+this.selectedClass+" { outline:3px solid orange !important; }#testisimo-overlay { z-index:9998;position:fixed;top:0px;bottom:0px;left:0px;right:0px;cursor:crosshair;opacity:0.2;background: linear-gradient(45deg, rgba(0,0,0,0.0980392) 25%, rgba(0,0,0,0) 25%, rgba(0,0,0,0) 75%, rgba(0,0,0,0.0980392) 75%, rgba(0,0,0,0.0980392) 0), linear-gradient(45deg, rgba(0,0,0,0.0980392) 25%, rgba(0,0,0,0) 25%, rgba(0,0,0,0) 75%, rgba(0,0,0,0.0980392) 75%, rgba(0,0,0,0.0980392) 0);background-position: 0 0, 40px 40px;background-origin: padding-box;background-clip: border-box;background-size: 80px 80px;}#testisimo-container { z-index:9999;position:fixed;width:300px;background-color:#fff;box-shadow:0px 0px 30px 0px rgba(50, 50, 50, 0.75);padding:25px 0px; }.testisimo-iframe { border:none;width:100%;height:100%; }#testisimo-container-header { height:25px;background-color:#000;cursor:move;position:absolute;top:0;left:0;right:0; }#testisimo-container-footer { height:25px;background-color:#000;cursor:row-resize;position:absolute;bottom:0;left:0;right:0; }#testisimo-container-overlay { z-index:1;position:absolute;top:0px;left:0px;bottom:0px;right:0px;display:none;cursor:move; }#testisimo-container.testisimo-dragged #testisimo-container-overlay { display:block; }#testisimo-container-header button { border:none;background-color:transparent;font-size:12px;color:#fff;padding:2px 10px; }.testisimo-icon, .testisimo-icon:focus, .testisimo-icon:active { background-repeat:no-repeat;background-position:center;outline:none; }.testisimo-icon-pin { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAYFBMVEUAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDPKpCdAAAAH3RSTlMAAQINGh4pLzY8QEpMVVtnb3CUm6CvvsXKz+bx8/n7jVbynAAAAE9JREFUeAGNx0cWhCAUBMCeQcWcc6Dvf0v1C+/JztoVLg1vW4BHSxHBmkpD5nDG5CDTb/3NlSELO7VSdBA9LS1dXDM4e4y3IfRaK6/6D3ECwWMHu2qhe6cAAAAASUVORK5CYII=);}.testisimo-icon-bars { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAADtZjDiAAAAIVBMVEUAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcWqnoAAAACnRSTlMAAQIGY2R40dPvH5wsVAAAACdJREFUCFtjYIACZWMQMGSYtQoEljF0gemlDOigCiy+BK4Opo9IcwCKrB8iFAmPNQAAAABJRU5ErkJggg==);}.testisimo-icon-caret-up {	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAAHlBMVEUAAACAgICAgICAgICAgICAgICAgICAgICAgICAgIAAvJH/AAAACXRSTlMAARVkaZKVpc+5VbSfAAAALklEQVR42p3HuREAIBADMR+/+2+YgWQhBGXSh3StuMU5rzO+xvd4NqrUjRF6MQGnCgH5SY+SpgAAAABJRU5ErkJggg==);}.testisimo-icon-arrow-left { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAADtZjDiAAAAJ1BMVEUAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIBjwPSjAAAADHRSTlMAAgQFBwibvMDO0/cbjaSWAAAAIElEQVQIW2NgIATEIBRTDYT2PAMCpxmioDRzD6o6AgAAfkwLa2yaHx8AAAAASUVORK5CYII=);}.testisimo-icon-arrow-right { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAADtZjDiAAAALVBMVEUAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDaI72bAAAADnRSTlMAAgQFBgiVm7e+ytH3+SaT/zIAAAAkSURBVAhbY2AgBhRCFb00YDj3DgS2MtwD00sgEi8UIHQiQcMAVFAPRZn9mbAAAAAASUVORK5CYII=);}",document.body.appendChild(t)},n.prototype.addContainer=function(){function t(t){return t.preventDefault(),d.toggleClass(i,"testisimo-dragged"),i.dragOffsetX=t.clientX-parseInt(i.style.left,10),i.dragOffsetY=t.clientY-parseInt(i.style.top,10),document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),p=!0,!1}function e(t){var e,n;if(p)return e=i.dragOffsetX,n=i.dragOffsetY,i.style.left=t.clientX-e+"px",i.style.top=t.clientY-n+"px",!1}function n(){p=!1,d.toggleClass(i,"testisimo-dragged"),document.removeEventListener("mousemove",e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",n),d.container.updateOpts()}function o(t){return t.preventDefault(),d.toggleClass(i,"testisimo-dragged"),i.dragClientY=t.clientY,i.dragHeight=parseInt(i.style.height,10),document.addEventListener("mousemove",s),document.addEventListener("mouseup",n),p=!0,!1}function s(t){return p?(i.style.height=i.dragHeight+t.clientY-i.dragClientY+"px",!1):void 0}var r,a,c,l,p,d=this,u=d.localStore.getOptions();i=document.createElement("DIV"),i.id="testisimo-container",r=window.innerHeight-60,a=window.innerWidth-320,c=parseInt(u.top,10)||20,l=parseInt(u.left,10)||20,0>c?c=20:c>r&&(c=r),0>l?l=20:l>a&&(l=a),i.style.top=c+"px",i.style.left=l+"px",i.style.height=u.height||"500px",i.style.position=u.position||"fixed",i.innerHTML='<div id="testisimo-container-header"><button class="testisimo-icon testisimo-icon-pin" onmousedown="event.stopPropagation()" onclick="testisimo.container.pin()">&nbsp;</button><button class="testisimo-icon testisimo-icon-arrow-left" onmousedown="event.stopPropagation()" onclick="testisimo.container.left()">&nbsp;</button><button class="testisimo-icon testisimo-icon-arrow-right" onmousedown="event.stopPropagation()" onclick="testisimo.container.right()">&nbsp;</button><button class="testisimo-icon testisimo-icon-caret-up" onmousedown="event.stopPropagation()" onclick="testisimo.container.collapse()" style="float:right">&nbsp;</button></div><iframe id="'+this.iframeId+'" class="testisimo-iframe"></iframe><div id="testisimo-container-footer" class="testisimo-icon testisimo-icon-bars"></div><div id="testisimo-container-overlay"></div>',document.body.appendChild(i),document.getElementById("testisimo-container-header").addEventListener("mousedown",t),document.getElementById("testisimo-container-footer").addEventListener("mousedown",o),p=!1},n.prototype.container={updateOpts:function(){testisimo.localStore.setOptions({top:i.style.top,left:i.style.left,height:i.style.height,position:i.style.position})},pin:function(){var t="absolute"===i.style.position;i.style.top=parseInt(i.style.top,10)+(t?-1:1)*document.body.scrollTop+"px",i.style.left=parseInt(i.style.left,10)+(t?-1:1)*document.body.scrollLeft+"px",i.style.position="absolute"===i.style.position?"fixed":"absolute",this.updateOpts()},left:function(){i.style.top="20px",i.style.left="20px",i.style.height=window.innerHeight-60+"px",this.updateOpts()},right:function(){i.style.top="20px",i.style.left=window.innerWidth-320+"px",i.style.height=window.innerHeight-60+"px",this.updateOpts()},collapse:function(){i.style.height="90px",this.updateOpts()}},n.prototype.getIframe=function(){var t=document.getElementById(this.iframeId);return t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument},n.prototype.getAppTemplates=function(){var t,e="",n=this.actions;for(t in n)n[t]&&(e+='<script type="text/ng-template" id="'+t+'">'+n[t].optsTemplate+"</script>");return e},n.prototype.addOverlay=function(){var t=document.createElement("DIV");t.id="testisimo-overlay",document.body.appendChild(t),t.addEventListener("click",this.overlayClick)},n.prototype.getOverlay=function(){return document.getElementById("testisimo-overlay")},n.prototype.removeOverlay=function(){var t=this.getOverlay();t.removeEventListener("click",this.overlayClick),t.parentElement.removeChild(t)},n.prototype.overlayClick=function(t){var e,n;t.stopPropagation(),e=t.x,n=t.y,testisimo.removeOverlay(),setTimeout(function(){var t=document.elementFromPoint(e,n);testisimo.clearClass(testisimo.selectedClass),testisimo.toggleClass(t,testisimo.selectedClass),testisimo.emit("selected",{tagName:t.tagName,attrs:testisimo.getAttributes(t)})},0)},n.prototype.toggleClass=function(t,e){return t.className.indexOf(e)>-1?(t.className=t.className.replace(" "+e,""),!1):(t.className=t.className+" "+e,!0)},n.prototype.clearClass=function(t){var e,n=document.querySelectorAll("."+t);for(e=0;e<n.length;e++)this.toggleClass(n[e],t)},n.prototype.getAttributes=function(t){var e,n,o={},s=t.attributes;if(!s)return{};for(n=0;n<s.length;n++)e=s[n].name,o[e]=s[n].value,"class"===e&&(o[e]=o[e].replace(" testisimo-selected",""));return o},n.prototype.getElementParents=function(t){for(var e=[];t.parentNode;)e.push(t.parentNode),t=t.parentNode;return e},n.prototype.traverseDOM=function(t,e){var n,o;for(e=e||document,n=e.childNodes,o=0;o<n.length;o++)if(t(n[o],this.getAttributes(n[o]))||this.traverseDOM(t,n[o]))return!0},n.prototype.escapeRegExp=function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},n.prototype.selectorRegExp=function(t,e){return e=e||"","="===t?new RegExp("^"+this.escapeRegExp(e)+"$","g"):"*"===t?new RegExp(".*"+this.escapeRegExp(e)+".*","g"):"~"===t?new RegExp("([\\s]+|^)("+this.escapeRegExp(e)+")([\\s]+|$)","g"):"|"===t?new RegExp("([-]+|^)("+this.escapeRegExp(e)+")([-]+|$)","g"):"*"===t?new RegExp(".*"+this.escapeRegExp(e)+".*","g"):"^"===t?new RegExp("^"+this.escapeRegExp(e)+".*","g"):"$"===t?new RegExp(".*"+this.escapeRegExp(e)+"$","g"):void 0},n.prototype.searchDOM=function(t,e,n){var o,s,i,r,a,c,l,p,d,u,g=[];t=this.replaceVariables(t||"",n);for(a in e)c=["=","~","|","^","$","*"].indexOf(e[a][0])>-1?e[a][0]:"",l=c?e[a].substring(1):e[a],l=this.replaceVariables(l,n),a=this.replaceVariables(a,n),"innerText"===a||"textContent"===a?l&&(i=this.selectorRegExp(c,l)):"isVisible"===a?r=l:t+="tagName"===a?l:"["+a+("="===c?"":c)+'="'+l+'"]';try{p=document.querySelectorAll(t||"*")}catch(m){p=[]}for(d=0;d<p.length;d++){if(o=this.getAttributes(p[d]),s=p[d].tagName,r||""===r)if("false"===r){if(null!==p[d].offsetParent)continue}else if(null===p[d].offsetParent)continue;i?(u=p[d].innerText||p[d].textContent,u.match(i)&&g.push({elm:p[d],attrs:o,tagName:s})):g.push({elm:p[d],attrs:o,tagName:s})}return g},n.prototype.selectMode=function(){this.addOverlay()},n.prototype.selectElements=function(t,e,n){var o,s;for(this.clearClass(this.selectedClass),o=this.searchDOM(t,e,n),s=0;s<o.length;s++)this.toggleClass(o[s].elm,this.selectedClass);return o},n.prototype.init=function(e,n){function o(){setTimeout(function(){var o,i;for(s.addStyles(),s.addContainer(),o=s.getIframe(),o.testisimo=s,o.document.open(),o.document.write(s.appHTML()),o.document.close(),i=0;i<window.frames.length;i++)try{t(window.frames[i])}catch(a){console.warn("Cannot add Errors Listener to iframe: "+a.message)}if(r.length)for(i=0;i<r.length;i++)this.error(r[i].error,r[i].file,r[i].line,r[i].column);e&&setTimeout(e,n||0)},50)}var s=this;["loaded","interactive","complete"].indexOf(document.readyState)>-1?o():window.addEventListener("load",o)},n.prototype.sessionStore={get:function(){var t=window.sessionStorage.getItem("testisimo:session");return t?JSON.parse(t):{}},set:function(t){window.sessionStorage.setItem("testisimo:session",JSON.stringify(t))}},n.prototype.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},n.prototype.localStore={getOptions:function(){return JSON.parse(window.localStorage.getItem("testisimo:options")||"{}")},setOptions:function(t){var e,n=this.getOptions();for(e in t)n[e]=t[e];window.localStorage.setItem("testisimo:options",JSON.stringify(t))},cache:null,stringify:function(t){return JSON.stringify(t,function(t,e){return"$"===t[0]?void 0:e})},cleanProjects:function(t){var e,n,o={};for(e in t){o[e]={name:t[e].name,tests:{}};for(n in t[e].tests)o[e].tests[n]={name:t[e].tests[n].name}}return o},getProjects:function(){var t,e,n,o;if(this.cache)return this.cache;t=window.localStorage.getItem("testisimo:projects")||"{}",e=JSON.parse(t);for(n in e){e[n].id=n;for(o in e[n].tests)e[n].tests[o].id=o,e[n].tests[o].projectId=n}return this.cache=e,this.cache},setProject:function(t){var e=this.getProjects();e[t.id]=t,window.localStorage.setItem("testisimo:projects",JSON.stringify(this.cleanProjects(e)))},createProject:function(t){var e=Object.keys(this.getProjects()).length,n={id:testisimo.guid(),name:t||"New Project "+(e?e+1:1)+" (Rename me)",tests:{}};return this.setProject(n),this.createTest(n),n},removeProject:function(t){var e,n;if(t="string"==typeof t?t:t.id,e=this.getProjects(),e[t]){for(n in e[t].tests)window.localStorage.removeItem("testisimo:tests:"+n);delete e[t],window.localStorage.setItem("testisimo:projects",JSON.stringify(this.cleanProjects(e)))}},getCurrentProject:function(){var t=this.getCurrentTest();return this.getProjects()[t.projectId]},getFirstProject:function(){var t=this.getProjects();return t[Object.keys(t)[0]]},exportProjectURL:function(t){var e,n,o;if(t="string"==typeof t?t:t.id,e=this.getProjects()[t],!e)throw new Error('Cannot create export URL, Project with Id "'+t+'" not found');n={id:e.id,name:e.name,tests:{}};for(o in e.tests)n.tests[o]=this.getTest(o);return"data:application/json;charset=utf-8,"+encodeURIComponent(this.stringify(n))},importProject:function(t){var e,n,o,s,i;try{if(e=JSON.parse(t),"[object Object]"!==Object.prototype.toString.call(e))return!1}catch(r){return!1}if("string"!=typeof e.id||"string"!=typeof e.name||"[object Object]"!==Object.prototype.toString.call(e.tests))throw new Error("Cannot import, seems like object is not project");s=e.id,n={},n[s]=e,o=this.cleanProjects(n)[s],o.id=s,this.setProject(o);for(i in o.tests)"[object Object]"===Object.prototype.toString.call(e.tests[i])&&(e.tests[i].id=i,e.tests[i].projectId=s,this.setTest(e.tests[i]));return!0},getFirstTest:function(t){t="string"==typeof t?t:t.id;var e=this.getProjects()[t];if(e)return e.tests[Object.keys(e.tests)[0]]},getCurrentTest:function(){var t,e=JSON.parse(window.localStorage.getItem("testisimo:current")||"{}"),n=this.getProjects(),o=n[e.projectId];return o||(o=this.getFirstProject()||this.createProject()),t=o.tests[e.testId],t||(t=this.getFirstTest(o)||this.createTest(o)),t},setCurrentTest:function(t){window.localStorage.setItem("testisimo:current",JSON.stringify(t?{testId:t.id,projectId:t.projectId}:{}))},getTest:function(t){var e,n;if(t="string"==typeof t?t:t.id,e=window.localStorage.getItem("testisimo:tests:"+t),!e)throw new Error('Cannot load Test "'+t+'", not found');if(e=JSON.parse(e),n=this.getProjects()[e.projectId],!n)throw new Error('Cannot load Test "'+t+'", Project "'+e.projectId+'" not found');return n[e.id]=e,e},setTest:function(t){var e=this.getProjects()[t.projectId];if(!e)throw new Error('Cannot create Test, Project with Id "'+t.projectId+'" not found');e.tests[t.id]=t,this.setProject(e),window.localStorage.setItem("testisimo:tests:"+t.id,this.stringify(t))},createTest:function(t){var e,n,o;if(t="string"==typeof t?t:t.id,e=this.getProjects()[t],!e)throw new Error('Cannot create Test, Project with Id "'+t+'" not found');return n=Object.keys(e.tests).length,o={id:testisimo.guid(),projectId:t,name:"New Test "+(n?n+1:1)+" (Rename me)",steps:[{selector:"",match:{},actions:[]}]},this.setTest(o),o},removeTest:function(t){var e=this.getProjects()[t.projectId];this.setCurrentTest(null),window.localStorage.removeItem("testisimo:tests:"+t.id),e&&e.tests[t.id]&&(delete e.tests[t.id],this.setProject(e),0===Object.keys(e.tests).length&&this.createTest(e))}},n.prototype.forceStop=!1,n.prototype.runningStepIndex=null,n.prototype.runningActionIndex=null,n.prototype.parentTests=[],n.prototype.extractVariableNames=function(t){if(!t)return[];if("string"!=typeof t)return[];var e=[];return t.replace(/\{([^\}\\]+)\}/g,function(t,n){e.push(n)}),e},n.prototype.replaceVariables=function(t,e){return e?t?"string"!=typeof t?"":t.replace(/\{([^\}\\]+)\}/g,function(t,n){return(e[n]||{}).value||""})||"":"":t},n.prototype.tryFindTargets=function(t,e,n,o,s){var i,r=this;return s=s||0,t||e&&0!==Object.keys(e).length?(i=r.searchDOM(t,e,n),i.length||s>r.maxWaitForElementAttempts||r.forceStop?o(i):void setTimeout(function(){r.tryFindTargets(t,e,n,o,s+1)},r.waitForElementInterval)):o([])},n.prototype.executeSteps=function(t,e,n,o){function s(){return r.forceStop?(r.parentTests.length||(r.forceStop=!1),void(n&&n())):(r.runningStepIndex=a.index||o,r.runningActionIndex=c[0].actionIndex,p={step:a.index||o,action:c[0].actionIndex},r.emit("execStart",p),void r.waitForAjaxDone(function(){l?i():r.tryFindTargets(a.selector,a.match,e,function(t){l=t,i()})}))}function i(){c[0].handler(l,c[0].opts,e,function(i){return r.runningStepIndex=null,r.runningActionIndex=null,"error"!==r.forceStop?i?(p={step:a.index||o,action:c[0].actionIndex,message:i.message||i},r.emit("execError",p),n?n(i,"execError",p):null):void setTimeout(function(){p={step:a.index||o,action:c[0].actionIndex},r.emit("execEnd",p),c.shift(),c.length?s():o+1<t.length?r.executeSteps(t,e,n,o+1):n&&n()},(r.minActionWait+(o+1<t.length?r.minStepWait:0))*r.speed):void 0})}var r,a,c,l,p,d,u,g,m;if(o=o||0,r=this,a=t[o],e=e||{},c=[],l=null,d="number"==typeof a.actionIndex&&a.actionIndex>-1?a.actionIndex:0,a){if(r.clearClass(this.selectedClass),0===a.actions.length||d>a.actions.length-1)return o+1<t.length?r.executeSteps(t,e,n,o+1):n?n():null;for(u=d;u<a.actions.length;u++){if(g=a.actions[u].action,!r.actions[g])return r.runningStepIndex=null,r.runningActionIndex=null,m=new Error('Step "'+((a.index||o)+1)+'": Action "'+g+'" not recognized'),p={step:a.index||o,action:u,message:m.message||m},r.emit("execError",p),n?n(m,"execError",p):null;c.push({actionIndex:u,action:g,handler:r.actions[g].handler,opts:a.actions[u].opts})}c.length?s():n&&n()}},n.prototype.error=function(t){var e=this;null!==e.runningStep&&(e.forceStop="error"),e.emit("execError",{step:e.runningStepIndex,action:e.runningActionIndex,message:t.message||t}),e.runningStepIndex=null,e.runningActionIndex=null,e.lastError=t.message||t},n.prototype.actions={},window.Testisimo=n,"function"==typeof window.testisimoConstructor&&window.testisimoConstructor(window.Testisimo),window.testisimo=new n,"function"==typeof window.testisimoInstance&&window.testisimoInstance(window.testisimo),window.testisimo.init()}(),Testisimo.prototype.appHTML=function(){return'<!DOCTYPE html><html xmlns:ng="http://angularjs.org" id="ng-app" ng-app="testisimo"><head><link href="'+(this.resources.useCDN?this.resources.fontAwesomeCDN:this.resources.fontAwesome)+'" rel="stylesheet"><link href="'+(this.resources.useCDN?this.resources.bootstrapCDN:this.resources.bootstrap)+'" rel="stylesheet"><script src="'+(this.resources.useCDN?this.resources.angularCDN:this.resources.angular)+'"></script><script type="text/javascript">('+this.appScript.toString()+")();</script>"+this.getAppTemplates()+'<style>body { margin-top:40px; }.footer { height:30px; }.btn-default.btn-circle { border-radius:50% }.btn.btn-light { background-color:transparent;border-color:transparent;color:#fff; }.test-nav { position:fixed;top:0px;left:0px;right:0px;background-color:#fff;z-index:9999;background-color:#000; }.test-nav-header { padding:5px;height:40px; }.step.bg-running { background-color:#0000ff; }.step.bg-error { background-color:#ff0000; }.action.bg-running input,.action.bg-running button { background-color:#ceceff; }.action.bg-error input,.action.bg-error button { background-color:#ffefef; }.step-wrapper { }.step-details { padding:5px;margin-bottom:10px; }.step-details label { font-size:11px;margin:0px; }.step-container { }.step { text-align:center;background-color:#808080;padding:5px;border-bottom:1px solid #000; }.step-options { margin-bottom:10px;padding:0px 5px; }.details-container, .error-container { background-color:#eee;border-bottom-left-radius:4px;border-bottom-right-radius:4px;padding:5px;margin:5px;margin-top:0px; }.error-container { color:#ff0000;background-color:#ffefef;font-size:11px;word-wrap:break-word;white-space:normal;padding-top:12px;margin-top:-7px; }.details { }.alert-danger { color:#ff0000;background-color:#ffefef;word-wrap:break-word;white-space:normal;margin:5px; }.nowrap { text-overflow:ellipsis;white-space:nowrap;display:block;width:100%;overflow:hidden; }.dropdown-item-project { font-size:14px;padding-left:5px !important; }.dropdown-item-test a { font-size:11px }</style></head><body><div ng-controller="TestCtrl"><div class="test-nav"><div class="test-nav-header"><div class="pull-left" style="width:30%"><div class="btn-group btn-group-sm"><button class="btn btn-light" ng-click="execSteps(test.steps)" ng-disabled="test.steps.$status===\'executing\'"><i class="fa" ng-class="{\'fa-play\':test.steps.$status!==\'executing\',\'fa-cog fa-spin\':test.steps.$status===\'executing\'}"></i></button><button class="btn btn-light" ng-click="execStop()"><i class="fa" ng-class="{\'fa-stop\':test.steps.$status!==\'stopping\',\'fa-cog fa-spin\':test.steps.$status===\'stopping\'}"></i></button></div></div><div class="pull-left" style="width:70%"><div class="dropdown"><button class="btn btn-sm btn-default dropdown-toggle" style="width:100%"><span class="nowrap">{{test.name||\'(Empty Name)\'}}</span></button><ul class="dropdown-menu" style="left:-40%;width:140%;"><li ng-repeat-start="(projectId,project) in projects" class="dropdown-item-project" ng-click="$event.stopPropagation()"><strong ng-if="!project.$editName" class="nowrap pull-left" style="width:72%;">&nbsp;{{project.name}}</strong><div class="input-group" ng-if="project.$editName"><input type="text" class="form-control input-sm" ng-model="project.name"><span class="input-group-btn"><button class="btn btn-default btn-sm" ng-click="updateProject(project);project.$editName=false"><i class="fa fa-check"></i></button></span></div><div ng-if="!project.$editName" class="pull-right"><button class="btn btn-default btn-xs btn-circle" style="border:none" ng-click="project.$editName=true"><i class="fa fa-pencil"></i></button><a href="" class="btn btn-default btn-xs btn-circle" style="border:none" ng-click="exportProject($event,project)" download="{{project.name}}.json"><i class="fa fa-download"></i></a><button class="btn btn-default btn-xs btn-circle" style="border:none" ng-click="removeProject(project)"><i class="fa fa-trash"></i></button></div></li><li ng-repeat-end ng-repeat="(testId,projectTest) in project.tests" class="nowrap dropdown-item-test" ng-class="{active:projectTest.id===test.id}"><a href="" ng-click="selectTest(projectTest)">{{projectTest.name||\'(Empty Name)\'}}</a></li><li class="divider"></li><li ng-click="$event.stopPropagation()"><div class="input-group" style="margin:0px 5px;"><input type="text" class="form-control input-sm" ng-model="newProjectName" placeholder="Project Name, or JSON Data"><span class="input-group-btn"><button class="btn btn-default btn-sm" ng-click="createProject(newProjectName);newProjectName=\'\'"><i class="fa fa-plus"></i></button></span></div></li></ul></div></div></div><div class="alert alert-danger" ng-if="error.message"><button class="close" ng-click="error.message=null">&times;</button><strong>Uncaught Error Occured:</strong><br><small>{{error.message}}</small></div></div><div class="step-details"><strong class="nowrap" style="margin-bottom:5px;">{{project.name}}</strong><div class="btn-group btn-group-xs" style="width:100%"><button class="btn btn-default btn-xs" style="width:50%" ng-click="createTest()"><i class="fa fa-plus"></i> Create Test</button><button class="btn btn-default btn-xs" style="width:50%" ng-click="removeTest()"><i class="fa fa-trash"></i> Remove Test</button></div><label>Test Name</label><input type="text" class="form-control input-sm" ng-model="test.name" style="margin-bottom:5px"><label ng-if="objectKeys(test.variables).length">Test Variables (e.g. "{my_var}")</label><div class="clearfix"></div><div ng-repeat="(key,value) in test.variables"><input type="text" class="form-control input-sm pull-left" ng-model="key" placeholder="key" disabled="disabled" style="width:50%"><input type="text" class="form-control input-sm pull-left" ng-model="test.variables[key].value" placeholder="value" style="width:50%"></div><div class="clearfix"></div></div><div ng-repeat="step in test.steps"><div class="step-wrapper"><div class="step-container"><div class="step" ng-class="{\'bg-error\':step.$error,\'bg-running\':step.$executing}""><button class="btn btn-default btn-xs btn-circle text-center pull-left" ng-click="step.$collapsed=!step.$collapsed" ng-style="{\'background-color\':step.$collapsed?\'transparent\':null}"><strong>{{$index+1}}.</strong></button><div class="btn-group btn-group-xs"><button class="btn btn-light btn-xs btn-circle" ng-click="execStep(step)" ng-disabled="step.$executing || !step.actions.length"><i class="fa fa-play" ng-class="{\'fa-play\':!step.$executing,\'fa-cog fa-spin\':step.$executing}"></i></button><button class="btn btn-light btn-xs btn-circle" ng-click="execFromStep(step)" ng-disabled="step.$executing || !step.actions.length"><i class="fa fa-step-forward"></i></button></div>&nbsp;<div class="btn-group btn-group-xs"><button class="btn btn-light btn-xs btn-circle" ng-click="copyStep(step)" ng-disabled="step.$executing"><i class="fa fa-copy"></i></button><button class="btn btn-light btn-xs btn-circle" ng-click="test.steps.splice($index+1,0,{actions:[{}] })" ng-disabled="step.$executing"><i class="fa fa-plus"></i></button></div>&nbsp;<div class="btn-group btn-group-xs"><button class="btn btn-light btn-xs btn-circle" ng-click="moveStep(step, $index-1)" ng-disabled="step.$executing || $first"><i class="fa fa-arrow-up"></i></button><button class="btn btn-light btn-xs btn-circle" ng-click="moveStep(step, $index+1)" ng-disabled="step.$executing || $last"><i class="fa fa-arrow-down"></i></button></div><button class="btn btn-light btn-xs btn-circle pull-right" ng-click="test.steps.splice($index, 1)" ng-disabled="step.$executing || test.steps.length===1"><i class="fa fa-trash"></i></button></div><div class="step-options" ng-if="!step.$collapsed"><div style="margin-top:2px;"><div class="input-group"><input type="text" class="form-control input-sm" placeholder="selected elements" value="{{selectedElementPreview(step)}}" disabled="disabled"><span class="input-group-btn"><button class="btn btn-default btn-sm" ng-click="expanded={elements:!expanded.elements};step.$selector=step.selector;step.$match=objectToArrayMatch(step.match)" ng-class="{active:expanded.elements}"><i class="fa fa-fw fa-code"></i></button></span></div></div><div class="details-container" ng-if="expanded.elements"><div class="details"><button class="btn btn-default btn-sm" ng-click="step.$selectionMode||selectElements(step)" style="width:50%" ng-class="{active:step.$selectionMode}"><i class="fa fa-crosshairs"></i> Pick</button><button class="btn btn-default btn-sm" ng-click="showSelectedElements(step)" style="width:50%"><i class="fa fa-eye"></i> Show ({{step.$selectedLength||0}})</button><div class="text-center"><small>css selector (and optional attributes)</small><input type="text" class="form-control input-sm" ng-model="step.$selector" placeholder="css selector" ng-change="step.selector=step.$selector"></div><div ng-repeat="attr in step.$match"><input class="form-control input-sm pull-left" ng-model="attr.name" ng-change="updateMatch(step)" style="width:40%" placeholder="attr. name"><div class="dropdown pull-left" style="width:10%;"><button class="btn btn-sm btn-default dropdown-toggle" style="width:100%;padding:2px 0px;"><span style="font-size:16px">{{attr.operator}}</span></button><ul class="dropdown-menu" style="left:-92px;"><li><a href="" ng-click="attr.operator=\'=\';updateMAtch(step)"><strong>=</strong>&nbsp;&nbsp;exact match</a></li><li><a href="" ng-click="attr.operator=\'*\';updateMatch(step)"><strong>*</strong>&nbsp;&nbsp;contains substring</a></li><li><a href="" ng-click="attr.operator=\'~\';updateMatch(step)"><strong>~</strong>&nbsp;&nbsp;is in space separated list</a></li><li><a href="" ng-click="attr.operator=\'|\';updateMatch(step)"><strong>|</strong>&nbsp;&nbsp;is in hyphen separated list</a></li><li><a href="" ng-click="attr.operator=\'^\';updateMatch(step)"><strong>^</strong>&nbsp;&nbsp;starts with</a></li><li><a href="" ng-click="attr.operator=\'$\';updateMatch(step)"><strong>$</strong>&nbsp;&nbsp;ends with</a></li></ul></div><input class="form-control input-sm pull-left" ng-model="attr.value" ng-change="updateMatch(step)" style="width:40%" placeholder="value"><button class="btn btn-sm btn-default" ng-click="step.$match.splice($index,1);updateMatch(step)" style="width:10%;padding:5px 0px;"><i class="fa fa-minus"></i></button></div><div class="text-center"><button class="btn btn-default btn-xs btn-circle" ng-click="step.$match.push({operator:\'=\',value:\'\'});updateMatch(step)"><i class="fa fa-plus"></i></button></div></div></div><div><div ng-repeat-start="action in step.actions track by $index" class="action" style="margin-top:2px;" ng-class="{\'bg-error\':action.$error,\'bg-running\':action.$executing}"><div class="input-group"><input type="text" class="form-control input-sm" placeholder="action details" disabled="disabled" value="{{actionPreview(action)}}"><span class="input-group-btn"><button class="btn btn-default btn-sm" ng-click="action.$expanded=!action.$expanded" ng-class="{active:action.$expanded}"><i class="fa fa-fw fa-cog"></i></button></span></div></div><div ng-repeat-end><div class="details-container" ng-if="action.$expanded"><div class="details"><button class="btn btn-default btn-sm" style="width:25%" ng-click="execStep(step, $index)" ng-disabled="!action.action"><i class="fa fa-play"></i></button><button class="btn btn-default btn-sm" style="width:25%" ng-click="moveAction(step,action,$index-1)" ng-disabled="$first"><i class="fa fa-arrow-up"></i></button><button class="btn btn-default btn-sm" style="width:25%" ng-click="moveAction(step,action,$index+1)" ng-disabled="$last"><i class="fa fa-arrow-down"></i></button><button class="btn btn-default btn-sm" style="width:25%" ng-click="step.actions.splice($index,1)"><i class="fa fa-trash"></i></button><select class="form-control input-sm" placeholder="action" ng-options="id as a.name for (id,a) in availableActions" ng-model="action.action"></select><div action-template></div></div></div><div class="error-container" ng-if="action.$error"><div class="details">{{action.$error}}</div></div></div></div><div class="text-center"><button class="btn btn-default btn-xs btn-circle" ng-click="step.actions.push({$expanded:true})"><i class="fa fa-cog"></i></button></div></div></div></div></div></div><div class="footer"></div><h5 class="text-center">Testisimo &copy; 2016</h5></body></html>';

},Testisimo.prototype.appScript=function(){angular.module("testisimo",[]).run(["$rootScope","testisimo",function(t){testisimo.addEventListener(function(e,n){t.$broadcast("testisimo:"+e,n)})}]).factory("testisimo",["$window",function(t){return t.testisimo}]).directive("dropdown",["$document",function(t){return{restrict:"C",link:function(e,n){function o(){n.removeClass("open"),t.off("click",o)}var s=angular.element(n[0].querySelector(".dropdown-toggle"));s.on("click",function(e){n.hasClass("open")||(e.stopPropagation(),n.addClass("open"),t.on("click",o))}),e.$on("$destroy",function(){t.off("click",o)})}}}]).directive("actionTemplate",["testisimo",function(t){return{restrict:"A",template:'<div ng-include="$parent.action.action"></div>',link:function(e){function n(){var n,s=t.actions[e.$parent.action.action];if(o.length)for(n in e)o.indexOf(n)>-1&&delete e[n];if(!s||!s.optsTemplateScope)return void(o=[]);for(n in s.optsTemplateScope)e[n]=s.optsTemplateScope[n];o=Object.keys(s.optsTemplateScope)}e.$watch(function(){return e.$parent.action.action},n);var o=[]}}}]).directive("stepContainer",["$window",function(t){return{restrict:"C",link:function(e,n){e.$on("testisimo:execError",function(o,s){e.executingSequence&&e.$index===s.step&&t.scrollTo(0,n[0].offsetTop-140)})}}}]).controller("TestCtrl",["$scope","$timeout","$interval","testisimo",function(t,e,n,o){function s(t,e){var n,o,s=[],i={};for(n in t)s.push({key:n,value:t[n][e]});for(s.sort(function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}),o=0;o<s.length;o++)i[s[o].key]=t[s[o].key];return i}function i(t,e,n){var o,s;for(e=e||"name",n=n||"value",o={},s=0;s<t.length;s++)t[s][e]&&"$"!==t[s][e][0]&&(o[t[s][e]]=t[s][n]);return o}function r(t,e,n){var o,s,i;e=e||"name",n=n||"value",o=[];for(s in t)"$"!==s[0]&&(i={},i[e]=s,i[n]=t[s],o.push(i));return o}function a(t,e,n){for(var o=0;o<n.length;o++)e[n[o]]={value:t[n[o]]?t[n[o]].value||"":""}}function c(e){var n,s,i,r,c,l,p=e.variables||{},d={};for(i=0;i<e.steps.length;i++){n=e.steps[i],a(p,d,o.extractVariableNames(n.selector));for(r in n.match)a(p,d,o.extractVariableNames(r)),a(p,d,o.extractVariableNames(n.match[r]));for(c=0;c<n.actions.length;c++)if(s=t.availableActions[n.actions[c].action])if(n.actions[c].opts=n.actions[c].opts||{},"function"==typeof s.optsVariables)a(p,d,s.optsVariables(n.actions[c].opts));else if(s.optsVariables)for(l=0;l<s.optsVariables.length;l++)a(p,d,o.extractVariableNames(n.actions[c].opts[s.optsVariables[l]]))}e.variables=d}var l,p,d,u,g,m,f;t.wasResumed=!1,t.log=function(){console.log(arguments.length>=1?arguments[0]:arguments)},t.testisimo=o,t.copy=angular.copy,t.merge=angular.merge,t.objectKeys=function(t){return Object.keys(t||{})},t.executingSequence=!1,t.execStep=function(e,n){var s,i;t.executingSequence=!1,s=t.test.steps.indexOf(e),-1!==s&&(i=angular.copy(e),i.index=s,"number"==typeof n&&n>-1&&(i.actionIndex=n,i.actions=i.actions.slice(0,n+1)),o.executeSteps([i],t.test.variables))},t.execFromStep=function(e,n){var s,i;t.executingSequence=!0,s=t.test.steps.indexOf(e),i=angular.copy(t.test.steps),"number"==typeof n&&n>-1&&(i[s].actionIndex=n),s>-1&&o.executeSteps(i,t.test.variables,null,s)},t.execSteps=function(e){t.executingSequence=!0,o.executeSteps(e,t.test.variables)},t.execStop=function(){t.test.steps.$status="stopping",o.forceStop=!0},t.$on("testisimo:execStart",function(n,s){o.sessionStore.set({projectId:t.test.projectId,testId:t.test.id,status:"executing",step:s.step,action:s.action,parentTests:o.parentTests,executingSequence:t.executingSequence,resumed:t.wasResumed}),e(function(){t.test.steps.$status="executing",t.test.steps[s.step].$executing=!0,t.test.steps[s.step].$error=!1;for(var e=0;e<t.test.steps[s.step].actions.length;e++)t.test.steps[s.step].actions[e].$executing=!1,t.test.steps[s.step].actions[e].$error=null;t.test.steps[s.step].actions[s.action].$executing=!0,t.test.steps[s.step].actions[s.action].$error=null})}),t.error={message:o.lastError},t.$on("testisimo:execError",function(n,s){t.wasResumed=!1,o.sessionStore.set({projectId:t.test.projectId,testId:t.test.id,status:"error",step:s.step,action:s.action,parentTests:o.parentTests,resumed:t.wasResumed}),e(function(){return null===s.step?t.error.message=s.message:(t.test.steps.$status="",t.test.steps[s.step].$executing=!1,t.test.steps[s.step].$error=!0,t.test.steps[s.step].actions[s.action].$executing=!1,void(t.test.steps[s.step].actions[s.action].$error=s.message))})}),t.$on("testisimo:execEnd",function(n,s){t.wasResumed=!1,o.sessionStore.set({projectId:t.test.projectId,testId:t.test.id,status:"end",step:s.step,action:s.action,parentTests:o.parentTests,resumed:t.wasResumed}),e(function(){t.test.steps.$status="",t.test.steps[s.step].$executing=!1,t.test.steps[s.step].$error=!1,t.test.steps[s.step].actions[s.action].$executing=!1})}),t.availableActions=s(o.actions,"name"),t.copyStep=function(e){var n,o=t.test.steps.indexOf(e),s=angular.copy(e);for(s.$error=null,n=0;n<s.actions.length;n++)s.actions[n].$error=null;t.test.steps.splice(o+1,0,s)},t.selectElements=function(e){e.$selectionMode=!0,l=function(n){e.$selector=(n.tagName||"").toLowerCase(),e.$match=[];for(var o in n.attrs)e.$match.push({name:o,operator:"=",value:n.attrs[o]});e.$match.push({name:"isVisible",operator:"=",value:"true"}),e.$selectionMode=!1,t.updateMatch(e)},o.selectMode()},t.$on("testisimo:selected",function(t,n){e(function(){l&&l(n),l=null})}),t.showSelectedElements=function(e){e.$selectedLength=o.selectElements(e.$selector,t.arrayToObjectMatch(e.$match),t.test.variables).length},t.arrayToObjectMatch=function(t){var e,n={};for(e=0;e<t.length;e++)t[e].name&&"$"!==t[e].name[0]&&(n[t[e].name]=t[e].operator+t[e].value);return n},t.objectToArrayMatch=function(t){var e,n,o=[];for(e in t)"$"!==e[0]&&(t[e]=t[e]||"",n={},n.name=e,n.operator=["=","~","|","^","$","*"].indexOf(t[e][0])>-1?t[e][0]:"",n.value=t[e].substring(n.operator?1:0),n.operator=n.operator||"=",o.push(n));return o},t.updateMatch=function(e){e.selector=e.$selector,e.match=t.arrayToObjectMatch(e.$match)},t.arrayToObject=i,t.objectToArray=r,t.selectedElementPreview=function(t){var e,n=t.selector;for(e in t.match)n+=(n?",":"")+e+"="+t.match[e];return n},t.actionPreview=function(e){var n,o,s,i;if(!e.action)return"";if(n=t.availableActions[e.action],n&&"function"==typeof n.optsPreview)return n.optsPreview(e.opts||{});o=!0,s=(n?n.name:e.action)+" (";for(i in e.opts||{})s+=(o?"":",")+i+"="+e.opts[i],o=!1;return s+")"},t.moveStep=function(e,n){var o=t.test.steps.indexOf(e);t.test.steps.splice(o,1),t.test.steps.splice(n,0,e)},t.moveAction=function(t,e,n){var o=t.actions.indexOf(e);t.actions.splice(o,1),t.actions.splice(n,0,e)},t.createTest=function(){t.test=o.localStore.createTest(t.project)},t.removeTest=function(){confirm('Remove Test "'+t.test.name+'" permanently ?')&&(o.localStore.removeTest(t.test),t.test=o.localStore.getCurrentTest(),t.test=o.localStore.getTest(t.test.id),t.project=o.localStore.getProjects()[t.test.projectId])},t.createProject=function(t){o.localStore.importProject(t)||o.localStore.createProject(t)},t.updateProject=function(t){o.localStore.setProject(t)},t.removeProject=function(e){confirm('Remove Project "'+(e||t.project).name+'" permanently ?')&&(o.localStore.removeProject(e||t.project),e&&e.id!==t.project.id||(t.test=o.localStore.getCurrentTest(),t.test=o.localStore.getTest(t.test.id),t.project=o.localStore.getProjects()[t.test.projectId]))},t.setCurrentTest=function(){o.localStore.setCurrentTest(t.test)},t.selectTest=function(e){t.test=o.localStore.getTest(e.id),t.project=o.localStore.getProjects()[e.projectId],t.setCurrentTest()},t.exportProject=function(t,e){var n="A"===t.target.tagName?t.target:t.target.parentNode;n.href=o.localStore.exportProjectURL(e)},t.projects=o.localStore.getProjects(),t.test=o.localStore.getCurrentTest(),t.selectTest(t.test),p=o.sessionStore.get(),"executing"===p.status&&(t.wasResumed=!0,d=t.test.steps[p.step],u=d?d.actions[p.action]:null,g=t.test.steps[p.step+1],o.parentTests=p.parentTests||[],u&&(t.availableActions[u.action]||{}).repeatAfterLocationChange&&p.action--,u?p.executingSequence?t.execFromStep(d,p.action+1):t.execStep(d,p.action+1):g&&p.executingSequence&&t.execFromStep(g,0)),m=null,t.$watch("test",function(t,e){null===m?m=!1:t&&e&&t.id===e.id&&(m=!0)},!0),f=n(function(){m&&(c(t.test),o.localStore.setTest(t.test),m=!1)},1e3),t.$on("$destroy",function(){n.cancel(f)})}])},t=!1,e=!0,function(t){try{return"a"==new t.KeyboardEvent("keyup",{key:"a"}).key}catch(e){return!1}}(this)||void function(){function t(t,e){var n,o,s,i,r,a,c,l,d,u,g,m,f,h,b,y,v,A,x;try{n=document.createEvent("KeyboardEvent")}catch(w){n=document.createEvent("Event")}e=e||{},o={};for(s in U)Y(U,s)&&(o[s]=s in e&&void 0!==(i=e[s])?i:U[s]);if(r=o.ctrlKey||!1,a=o.shiftKey||!1,c=o.altKey||!1,l=o.metaKey||!1,d=o.altGraphKey||!1,u=J>3?((r?"Control":"")+(a?" Shift":"")+(c?" Alt":"")+(l?" Meta":"")+(d?" AltGraph":"")).trim():null,g=(o.key||"")+"",m=(o["char"]||"")+"",f=o.location,h=g&&g.charCodeAt(0)||0,b=o.bubbles,y=o.cancelable,v=o.repeat,A=o.locale,x=!1,h=o.keyCode=o.keyCode||h,o.which=o.which||h,p||(n.__keyCode=h,n.__charCode=h,n.__which=h),"initKeyEvent"in n)n.initKeyEvent(t,b,y,C,r,c,a,l,h,h),x=!0;else if("initKeyboardEvent"in n&&W)try{1==J?(n.initKeyboardEvent(t,b,y,C,g,f,r,a,c,l,d),n.__char=m):2==J?n.initKeyboardEvent(t,b,y,C,r,c,a,l,h,h):3==J?(n.initKeyboardEvent(t,b,y,C,g,f,r,c,a,l,d),n.__char=m):4==J?(n.initKeyboardEvent(t,b,y,C,g,f,u,v,A),n.__char=m):5==J?n.initKeyboardEvent(t,b,y,C,m,g,f,u,v,A):n.initKeyboardEvent(t,b,y,C,g,f,u,v,A),x=!0}catch(k){W=!1}x||(n.initEvent(t,b,y,C),n.__char=m,n.__key=g,n.__location=f);for(s in U)Y(U,s)&&n[s]!=o[s]&&(delete n[s],P(n,s,{writable:!0,value:o[s]}));return"isTrusted"in n||(n.isTrusted=!1),n}function n(t){return t&&!(t in k)&&"U+"!==t.substring(0,2)}function o(t){var e,n,o,s=t.which||t.keyCode,i=this._this;t.ctrlKey||t.altKey||t.metaKey||(o=g[s])&&0!==o._key||t.__key||t.isTrusted===!1?(e=this._listener,"object"==typeof e&&"handleEvent"in e&&(i=e,e=e.handleEvent),e&&e.apply&&e.apply(i,arguments)):(n=i._||(i._={}),n[D]=s,"keyLocation"in t&&(n._keyLocation=t.keyLocation))}function s(t){var n,o,s,r,a,c=t.which||t.keyCode,u=this,g=u._;t.__stopNow||(g&&D in g?(n=g[D],delete g[D],t.__keyCode=n,(r=m[n])&&v&&r._keyCode&&(n=r._keyCode),"keyLocation"in t&&"_keyLocation"in g&&(delete t.keyLocation,t.keyLocation=g._keyLocation),e&&91>n&&n>64&&c!=n&&!m[n]&&(r=r||(m[n]={}),r._keyCode=n),a=r&&r._key||String.fromCharCode(n).toLowerCase(),t.__key=a,t.__char=String.fromCharCode(c),o=new C.KeyboardEvent("keydown",t),delete o.keyLocation,delete o.__location,d?(delete o.which,P(o,"which",{value:n})):o.__which=n,p&&(delete o.keyCode,P(o,"keyCode",{value:n})),o.__location=l.call(o),i||(r=r||(r=m[c]=m[n]={}),r._char=o["char"],e||(r._key=r._char)),s=!(t.target||u).dispatchEvent(o)):s=!t.ctrlKey&&(g=m[c])&&("object"==typeof g?g._key||"":g).length>1?2:0,s&&(s===!0&&t.preventDefault(),B?t.stopImmediatePropagation():(t.__stopNow=!0,t.stopPropagation())))}var i,r,a,c,l,p,d,u,g,m,f,h,b,y,v,A,x,w,k,C=this,I=0,_=1,E=2,T=3,S=4,j=5,$=C.Event.prototype,O=C.KeyboardEvent&&C.KeyboardEvent.prototype||$,P=Object.defineProperty||function(t,e,n){return"value"in n?void(t[e]=n.value):("get"in n&&t.__defineGetter__(e,n.get),void("set"in n&&t.__defineSetter__(e,n.set)))},M=Object.getOwnPropertyDescriptor,N=function(t,e){return"__lookupGetter__"in t?t.__lookupGetter__(e):M?(M(t,e)||{}).get:void 0},K={keydown:null,keyup:null,keypress:null},L=1,V="_h_9e2",R="_e_8vj",D=V+"__keyCode",U={"char":"",key:"",location:I,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,repeat:!1,locale:"",detail:0,bubbles:!1,cancelable:!1},B="stopImmediatePropagation"in document.createEvent("Event"),F=Array.prototype.slice,H=Function.prototype.bind||function(t){var e=this,n=F.call(arguments,1);return function(){return e.apply(t,n.concat(F.call(arguments)))}},Y=H.call(Function.prototype.call,Object.prototype.hasOwnProperty),W=!0,J=function(t){try{var e=t.call(document,"KeyboardEvent");return e.initKeyboardEvent("keyup",!1,!1,C,"+",3,!0,!1,!0,!1,!1),"+"==(e.keyIdentifier||e.key)&&3==(e.keyLocation||e.location)&&(e.ctrlKey?e.altKey?1:3:e.shiftKey?2:4)||"+"==e["char"]&&5||9}catch(n){return 0}}(document.createEvent),z=function(){try{return this&&new this("keyup",{key:"a","char":"b"})||{}}catch(t){return{}}}.call(C.KeyboardEvent),q={enumerable:!1,configurable:!0,writable:!0};for(M&&(i=N(O,"key")||N(z,"key"),r=N(O,"char")||N(z,"char"),a=N(O,"location")||N(z,"location"),c=N(O,"keyCode")),g={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",21:"KanaMode",22:"HangulMode",23:"JunjaMode",24:"FinalMode",25:"HanjaMode",27:"Esc",28:"Convert",29:"Nonconvert",30:"Accept",31:"ModeChange",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",41:"Select",43:"Execute",44:"PrintScreen",45:"Insert",46:"Del",47:"Help",91:{_key:"OS",_char:!1,_location:_},92:{_key:"OS",_char:!1,_location:E},93:"Menu",106:{_key:"Multiply",_char:"*",_location:T},107:{_key:"Add",_char:"+",_location:T},108:{_key:"Separator",_char:!1,_location:T},109:{_key:"Subtract",_char:"-",_location:T},110:{_key:"Decimal",_char:".",_location:T},111:{_key:"Divide",_char:"/",_location:T},144:{_key:"NumLock",_char:!1,_location:T},145:"ScrollLock",180:"LaunchMail",181:"SelectMedia",182:"LaunchApplication1",183:"LaunchApplication2",224:"Meta",229:"Process",246:"Attn",247:"Crsel",248:"Exsel",249:"EraseEof",251:"Zoom",254:"Clear"},m=e?{186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",226:"\\"}:{},f=C.navigator.userAgent.toLowerCase(),h=!!~(C.navigator.platform+"").indexOf("Mac"),b={},w=999,y=105;y>95;--y)x=y-96,m[x+48]=i?x+"":{_key:x+""},m[y]={_key:x+"",_location:T};if(!i)for(y in m)Y(m,y)&&"object"!=typeof m[y]&&(m[y]={_key:m[y]});for(y=135;y>111;--y)g[y]="F"+(y-111);if(C.opera)r||(v=!0,A=!0,g[57351]=g[93],m[187]=m[61]={_key:0,_keyCode:187},m[189]=m[109]={_key:0,_keyCode:189,_location:3});else{for(b.names=f.match(/(mozilla|compatible|chrome|webkit|safari)/gi),y=b.names&&b.names.length||0;y-->0;)b[b.names[y]]=!0;!b.mozilla||b.compatible||b.webkit?b.safari&&!b.chrome||b.chrome:(v=!0,b._version=+(f.match(/firefox\/([0-9]+)/)||[])[1],x=m[61]=m[187],x._keyCode=187,x=m[173]=m[189],x._keyCode=189,x=m[59]=m[186],x._keyCode=186,b._version<15&&(g[107]=g[61],m[109]=m[173]))}k={Escape:null,Win:null,Scroll:null,Apps:null,Delete:null,Window:null,ContextMenu:null,Mul:null},t.DOM_KEY_LOCATION_STANDARD=I,t.DOM_KEY_LOCATION_LEFT=_,t.DOM_KEY_LOCATION_RIGHT=E,t.DOM_KEY_LOCATION_NUMPAD=T,t.DOM_KEY_LOCATION_MOBILE=S,t.DOM_KEY_LOCATION_JOYSTICK=j,t.prototype=O,x=new t("keyup");try{delete x.keyCode,P(x,"keyCode",{writable:!0,value:9}),delete x.which,P(x,"which",{writable:!0,value:9})}catch(G){}d=9===x.which,!(p=9==x.keyCode)&&c?(P(O,"keyCode",{enumerable:!0,configurable:!0,get:function(){return"__keyCode"in this?this.__keyCode:c.call(this)},set:function(t){return this.__keyCode=isNaN(t)?0:t}}),P(O,"charCode",{enumerable:!0,configurable:!0,get:function(){return"__charCode"in this?this.__charCode:c.call(this)},set:function(t){return this.__charCode=isNaN(t)?0:t}})):c=void 0,e&&(u=function(t){var e,n,o,s,i;return t=t||"",t.length>1?t:(e=this.which||this.keyCode,"keypress"==this.type&&(e+=w),n=m[e],o=n&&"object"==typeof n,(s=o?n._key:n)?s:(i=n&&n._keyCode||e>64&&91>e&&e,(i&&String.fromCharCode(i)||t).toLowerCase()))}),P(O,"key",{enumerable:!0,configurable:!0,get:function(){var t,o,s,r,a=this;if(i&&(t=i.call(a),t&&t.length<2||n(t)))return e?u.call(this,t):t;if("__key"in a)return a.__key;if(a.type in K)return o=a.which||a.keyCode,s="keypress"!=a.type,s?"keyIdentifier"in a&&n(a.keyIdentifier)?t=a.keyIdentifier:e&&s&&!(t=g[o])?t=u.call(this,t):(t=t||m[o],r=t&&"object"==typeof t,t=(r?t._key:t)||a["char"]):t=a["char"],q.value=t,P(a,"__key",q),t}}),P(O,"char",{enumerable:!0,configurable:!0,get:function(){var t,e,o,s,i=this;if(i.type in K)return i.ctrlKey||i.altKey||i.metaKey?"":"__char"in i?i.__char:(e="keypress"!=i.type,o=!e&&i.__keyCode||i.which||i.keyCode,e&&(t=g[o])&&"object"!=typeof t?"":(r&&null!==(t=r.call(i))||(t=m[o]||g[o],s=t&&"object"==typeof t,s&&t._char!==!1?s&&void 0!==t._char?t=t._char||"":"keyIdentifier"in i&&n(i.keyIdentifier)?t="":(t=String.fromCharCode(o),e&&!i.shiftKey&&(t=t.toLowerCase())):t=""),q.value=t,P(i,"__char",q),t))}}),l=function(){var t,e,n,o=this;if(a)return a.call(this);if("__location"in o)return o.__location;if(o.type in K)return t=o.which||o.keyCode,e="keypress"!=o.type,"keyLocation"in o?n=o.keyLocation:(n=e&&(g[t]||m[t]),n="object"==typeof n&&n._location||I),q.value=n,P(o,"__location",q),n},P(O,"location",{enumerable:!0,configurable:!0,get:l}),r?document.addEventListener("keydown",function(t){var e,n,o,s=r?r.call(t):t["char"],i=s&&s.charCodeAt(0);i&&!m[i+=w]&&(n=m[i]={},e=t.keyCode,s=(o=m[e])?"object"==typeof o&&o._key||o:String.fromCharCode(e),e>64&&91>e&&e&&(s=s.toLowerCase()),n._key=s)},!0):[(x=C.Document)&&x.prototype||C.document,(x=C.HTMLDocument)&&x.prototype,(x=C.Window)&&x.prototype||C,(x=C.Node)&&x.prototype,(x=C.Element)&&x.prototype].forEach(function(t){if(t&&Y(t,"addEventListener")){var e=t.addEventListener,n=t.removeEventListener;e&&(t.addEventListener=function(t,n,i){var r,a,c,l,p=this;if("keydown"===(t+"").toLowerCase()){if(a=R+(i?"-":"")+t,c=a+(n[V]||(n[V]=++L)),l=a+"__count",(r=this._)||(r=this._={}),c in r)return;void 0===r[l]&&e.call(p,"keypress",s,!0),r[l]=(r[l]||0)+1,arguments[1]=r[c]=H.call(o,{_listener:n,_this:this})}return e.apply(p,arguments)},n&&(t.removeEventListener=function(t,e,o){var s,i,r,a,c=this;return"keydown"===(t+"").toLowerCase()&&(i=R+(o?"-":"")+t,r=i+e[V],a=i+"__count",s=c._,r&&s&&s[a]&&(--s[a],(arguments[1]=s[r])&&delete s[r])),n.apply(c,arguments)}))}}),C.KeyboardEvent=t,_=E=T=S=j=M=N=x=z=t=O=y=$=f=b=h=null}.call(this),Testisimo.prototype.actions.assertElements={name:"Assertion - Elements Count",optsTemplate:'<input type="text" class="form-control input-sm" placeholder="1" ng-model="action.opts.count">',optsPreview:function(t){return this.name+' "'+(t.count||"1")+'"'},handler:function(t,e,n,o){if(!(e.count||"").match(/^[0-9]*$/))return o(new Error('Value "'+e.count+'" is not valid Number'));var s=parseInt(e.count||"1",10);return t.length!==s?o(new Error('Assertion fail, expected "'+s+'" but found "'+t.length+'"')):void o()}},Testisimo.prototype.actions.click={name:"Click",optsTemplate:"",optsPreview:function(){return this.name},handler:function(t,e,n,o){return 0===t.length?o(new Error("Target element not found")):t.length>1?o(new Error("Multiple target elements found")):null===t[0].offsetParent?o(new Error("Target element is not visible")):(t[0].elm.focus(),t[0].elm.click(),void o())}},Testisimo.prototype.actions.keyboardWrite={name:"Keyboard Write",optsTemplate:'<input type="text" class="form-control input-sm" placeholder="text to write" ng-model="action.opts.text">',optsVariables:["text"],optsPreview:function(t){return this.name+' "'+(t.text||"")+'"'},handler:function(t,e,n,o){function s(t,e){return Math.floor(Math.random()*(e-t+1))+t}function i(t,e,n,o){return testisimo.forceStop?n?n():null:(o=o||0,0===o&&(r.focus(),r.value=""),void setTimeout(function(){var t,s={bubbles:!0,cancelable:!0,"char":e[o]};r.dispatchEvent(new KeyboardEvent("keydown",s)),r.dispatchEvent(new KeyboardEvent("keypress",s)),r.dispatchEvent(new KeyboardEvent("keyup",s)),r.value=r.value+e[o],t=document.createEvent("HTMLEvents"),t.initEvent("change",!1,!0),r.dispatchEvent(t),o+1<e.length?i(r,e,n,o+1):n&&n()},s(50,200)*testisimo.speed))}var r,a;return 0===t.length?o(new Error("Target element not found")):t.length>1?o(new Error("Multiple target elements not allowed")):null===t[0].offsetParent?o(new Error("Target element is not visible")):"INPUT"!==t[0].tagName&&"TEXTAREA"!==t[0].tagName?o(new Error("Target must be input or textarea")):["checkbox","radio"].indexOf(t[0].type)>-1?o(new Error("Boolean inputs (checkbox or radio) not allowed")):(r=t[0].elm,a=testisimo.replaceVariables(e.text,n),void i(r,a,o))}},Testisimo.prototype.actions.keyboardKeypress={name:"Keyboard Keypress",optsTemplateScope:{keyCodes:{backspace:"8",tab:"9",enter:"13",shift:"16",ctrl:"17",alt:"18",pause_break:"19",caps_lock:"20",escape:"27",page_up:"33","page down":"34",end:"35",home:"36",left_arrow:"37",up_arrow:"38",right_arrow:"39",down_arrow:"40",insert:"45","delete":"46",0:"48",1:"49",2:"50",3:"51",4:"52",5:"53",6:"54",7:"55",8:"56",9:"57",a:"65",b:"66",c:"67",d:"68",e:"69",f:"70",g:"71",h:"72",i:"73",j:"74",k:"75",l:"76",m:"77",n:"78",o:"79",p:"80",q:"81",r:"82",s:"83",t:"84",u:"85",v:"86",w:"87",x:"88",y:"89",z:"90","left_window key":"91","right_window key":"92",select_key:"93","numpad 0":"96","numpad 1":"97","numpad 2":"98","numpad 3":"99","numpad 4":"100","numpad 5":"101","numpad 6":"102","numpad 7":"103","numpad 8":"104","numpad 9":"105",multiply:"106",add:"107",subtract:"109","decimal point":"110",divide:"111",f1:"112",f2:"113",f3:"114",f4:"115",f5:"116",f6:"117",f7:"118",f8:"119",f9:"120",f10:"121",f11:"122",f12:"123",num_lock:"144",scroll_lock:"145",semi_colon:"186",equal_sign:"187",comma:"188",dash:"189",period:"190",forward_slash:"191",grave_accent:"192",open_bracket:"219",backslash:"220",closebracket:"221",single_quote:"222"},getKeyName:function(t){t=t.toString();for(var e in this.keyCodes)if(this.keyCodes[e]===t)return e;return t},setKey:function(t,e){t.preventDefault(),t.stopPropagation(),e.key={altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,keyIdentifier:t.keyIdentifier,charCode:t.charCode,keyCode:t.keyCode,name:(t.altKey&&18!==t.keyCode?"Alt + ":t.ctrlKey&&17!==t.keyCode?"Ctrl + ":t.shiftKey&&16!==t.keyCode?"Shift + ":t.metaKey&&"Meta"!==t.keyIdentifier?"Meta + ":"")+this.getKeyName(t.keyCode)}}},optsTemplate:'<input type="text" class="form-control input-sm" placeholder="press key" ng-model="action.opts.key.name" ng-keydown="setKey($event,action.opts)">',optsPreview:function(t){return this.name+' "'+((t.key||{}).name||"")+'"'},handler:function(t,e,n,o){function s(t,e){return Math.floor(Math.random()*(e-t+1))+t}var i,r;return 0===t.length?o(new Error("Target element not found")):t.length>1?o(new Error("Multiple target elements not allowed")):null===t[0].offsetParent?o(new Error("Target element is not visible")):"INPUT"!==t[0].tagName&&"TEXTAREA"!==t[0].tagName?o(new Error("Target must be input or textarea")):["checkbox","radio"].indexOf(t[0].type)>-1?o(new Error("Boolean inputs (checkbox or radio) not allowed")):(i=t[0].elm,r=e.key,i.focus(),void setTimeout(function(){var t={bubbles:!0,cancelable:!0,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey,keyIdentifier:r.keyIdentifier,charCode:r.charCode,keyCode:r.keyCode};i.dispatchEvent(new KeyboardEvent("keydown",t)),i.dispatchEvent(new KeyboardEvent("keypress",t)),i.dispatchEvent(new KeyboardEvent("keyup",t)),o()},s(50,200)*testisimo.speed))}},Testisimo.prototype.actions.locationSetUrl={name:"Location Set URL",optsTemplate:'<input type="text" class="form-control input-sm" placeholder="/mypath" ng-model="action.opts.location">',optsVariables:["location"],optsPreview:function(t){return this.name+' "'+(t.location||"")+'"'},handler:function(t,e,n,o){return e.location?(window.location=testisimo.replaceVariables(e.location,n),void o()):o(new Error("Location not set"))}},Testisimo.prototype.actions.locationReload={name:"Location Reload",optsTemplate:"",optsPreview:function(){return this.name},handler:function(t,e,n,o){window.location.reload(!0),o()}},Testisimo.prototype.actions.locationBack={name:"Location History Back (Backbutton)",optsTemplate:"",optsPreview:function(){return this.name},handler:function(t,e,n,o){window.history.back(),o()}},Testisimo.prototype.actions.runTest={name:"  Run Test",optsTemplateScope:{mergeVariables:function(t,e){defValues={};for(var n in t)defValues[n]={defaultValue:t[n].value};return angular.merge(defValues,e)}},optsTemplate:'<select class="form-control input-sm" placeholder="choose test" style="margin-bottom:5px"ng-options="t.id as t.name disable when t.id===test.id for (id,t) in project.tests" ng-model="action.opts.testId" ng-change="action.opts.testVariables=mergeVariables(testisimo.localStore.getTest(action.opts.testId).variables||{},{})"></select><div class="clearfix"><small><strong>Override Variables</strong></small><button class="btn btn-default btn-xs pull-right" ng-click="action.opts.testVariables=mergeVariables(testisimo.localStore.getTest(action.opts.testId).variables||{},action.opts.testVariables)"><i class="fa fa-refresh"></i> Refresh</button></div><div ng-repeat="(key,value) in action.opts.testVariables" class="clearfix"><input type="text" class="form-control input-sm pull-left" style="width:50%" ng-model="key" disabled="disabled"><input type="text" class="form-control input-sm pull-left" style="width:50%" ng-model="action.opts.testVariables[key].value" placeholder="{{action.opts.testVariables[key].defaultValue}}"></div>',optsVariables:function(t){var e,n=[];t.testVariables=t.testVariables||{};for(e in t.testVariables)t.testVariables[e].value&&(n=n.concat(testisimo.extractVariableNames(t.testVariables[e].value)));return n},optsPreview:function(t){var e=testisimo.localStore.getCurrentProject(),n=(e.tests[t.testId]||{}).name||"";return this.name.substring(1)+' "'+n+'"'},repeatAfterLocationChange:!0,handler:function(t,e,n,o){var s,i,r,a,c,l,p,d,u,g,m,f,h,b;if(!e.testId)return o(new Error("Test Id not defined, choose one in action details, please"));if(s=testisimo.localStore.getCurrentProject(),i=testisimo.localStore.getCurrentTest().id,r=testisimo.localStore.getCurrentTest().name,a=testisimo.localStore.getTest(e.testId),c=testisimo.sessionStore.get().resumed,l=0,p=0,!s.tests[e.testId]||!a)return o(new Error('Test "'+e.testId+'" not found in this project'));for(testisimo.parentTestsLevel=testisimo.parentTestsLevel||0,testisimo.parentTestsLevel>0&&(i=e.testId,r=a.name),d=-1,u={},g=0;g<testisimo.parentTests.length;g++){if(u[testisimo.parentTests[g].id])return o(new Error('Nested Test "'+testisimo.parentTests[g].name+'" duplicity found - preventing infinite loop'));u[testisimo.parentTests[g].id]=!0,testisimo.parentTests[g].id===i&&(d=g)}d>-1?(l=testisimo.parentTests[d].child.step,p=testisimo.parentTests[d].child.action,testisimo.actions[a.steps[l].actions[p].action].repeatAfterLocationChange||p++):(testisimo.parentTests.push({id:i,step:testisimo.runningStepIndex,action:testisimo.runningActionIndex}),d=testisimo.parentTests.length-1),m={},e.testVariables=e.testVariables||{};for(f in e.testVariables)e.testVariables[f].value&&(m[f]={value:testisimo.replaceVariables(e.testVariables[f].value||e.testVariables[f].defaultValue,n)});if(a.variables)for(f in a.variables)m[f]||(m[f]=a.variables[f]);return h=testisimo.eventsInterceptor,testisimo.eventsInterceptor=function(t,e,n){var o,i;if(e&&"number"==typeof e.step&&(testisimo.parentTests[d].child={step:e.step,action:e.action},e.step=testisimo.parentTests[0].step,e.action=testisimo.parentTests[0].action,e.message)){for(o="",i=1;i<testisimo.parentTests.length;i++)o+=s.tests[testisimo.parentTests[i].id].name+(i===testisimo.parentTests.length-1?": ":" --> ");e.message=o+e.message}n(t,e)},b=[].concat(a.steps),b[l]={selector:b[l].selector,match:b[l].match,actions:b[l].actions,actionIndex:p},testisimo.forceStop?o():(testisimo.parentTestsLevel++,void testisimo.executeSteps(b,m,function(t){if(!t){var e=testisimo.parentTests.pop();testisimo.runningStepIndex=e.step,testisimo.runningActionIndex=e.action}testisimo.eventsInterceptor=h,testisimo.parentTestsLevel--,o()},l))}},Testisimo.prototype.actions.wait={name:"Wait (sleep)",optsTemplate:'<input type="number" class="form-control input-sm" ng-model="action.opts.time" placeholder="0 ms">',optsPreview:function(t){return this.name+' "'+(t.time||0)+'"'},handler:function(t,e,n,o){setTimeout(o,e.time||0)}};
//# sourceMappingURL=./testisimo.min.js.map